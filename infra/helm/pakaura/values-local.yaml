# Local deployment values for Minikube (Docker driver on Windows)
# Access pattern: kubectl port-forward (localhost:3000 / localhost:8000)
global:
  namespace: pakaura
  imageTag: "latest"

frontend:
  image:
    pullPolicy: Never  # Use local images only
  env:
    # Frontend falls back to http://localhost:8000 when NEXT_PUBLIC_API_URL
    # is not set at build time, which matches port-forward access.
    apiUrl: "http://localhost:8000"
  probes:
    readiness:
      initialDelaySeconds: 15
      periodSeconds: 10
      timeoutSeconds: 3
    liveness:
      initialDelaySeconds: 30
      periodSeconds: 15
      timeoutSeconds: 3

api:
  image:
    pullPolicy: Never  # Use local images only
  env:
    # CORS origin must match the URL the browser uses to access the frontend
    frontendUrl: "http://localhost:3000"
    # T-020: Enable Dapr event publishing locally with Dapr sidecar
    daprEnabled: "true"
  service:
    type: ClusterIP  # Access via port-forward, not NodePort

# Enable Dapr components for Phase V (T-006)
# Plan ref: Plan §4.2 (Local — no auth, internal cluster)
dapr:
  enabled: true

# Local Kafka for Phase V (T-001)
# Plan ref: Plan §8.1 (single-broker Kafka on Minikube)
kafka:
  enabled: true
  image:
    pullPolicy: IfNotPresent  # Pulled from Docker Hub
  resources:
    limits:
      memory: "1Gi"
      cpu: "500m"
    requests:
      memory: "512Mi"
      cpu: "250m"

# Local PostgreSQL for Phase IV
postgres:
  enabled: true
  user: "pakaura"
  password: "local_dev_password"
  database: "pakaura_db"

# Secrets for local development
secrets:
  databaseUrl: "postgresql+asyncpg://pakaura:local_dev_password@postgres.pakaura.svc.cluster.local:5432/pakaura_db"
  jwtSecret: "local-dev-secret-key-change-in-production-min-32-chars-long"
  cohereApiKey: ""  # Empty for demo mode
