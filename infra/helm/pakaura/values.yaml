# Default values for pakaura Helm chart

# Global settings
global:
  namespace: pakaura
  imageTag: "4.0.0"

# Frontend configuration
frontend:
  enabled: true
  replicaCount: 1
  image:
    repository: pakaura-frontend
    tag: ""  # Defaults to global.imageTag
    pullPolicy: IfNotPresent
  resources:
    limits:
      memory: "256Mi"
      cpu: "250m"
    requests:
      memory: "128Mi"
      cpu: "100m"
  service:
    type: NodePort
    port: 3000
    nodePort: 30300
  env:
    apiUrl: ""  # Override for NEXT_PUBLIC_API_URL; defaults to internal K8s DNS
  probes:
    readiness:
      initialDelaySeconds: 10
      periodSeconds: 5
    liveness:
      initialDelaySeconds: 30
      periodSeconds: 10

# API configuration
api:
  enabled: true
  replicaCount: 1
  image:
    repository: pakaura-api
    tag: ""  # Defaults to global.imageTag
    pullPolicy: IfNotPresent
  resources:
    limits:
      memory: "512Mi"
      cpu: "500m"
    requests:
      memory: "256Mi"
      cpu: "250m"
  service:
    type: ClusterIP
    port: 8000
  probes:
    readiness:
      initialDelaySeconds: 10
      periodSeconds: 5
    liveness:
      initialDelaySeconds: 30
      periodSeconds: 10
  env:
    frontendUrl: ""  # Override for CORS origin; defaults to internal K8s DNS
    jwtAlgorithm: "HS256"
    jwtExpirationHours: "24"
    aiModel: "command-a-03-2025"
    aiTemperature: "0.3"
    aiMaxTokens: "300"
    aiTimeoutSeconds: "30"
    aiRateLimitPerMinute: "30"
    environment: "production"
    debug: "false"
    # T-020: Dapr event publishing configuration (Phase V Stage 4)
    daprEnabled: "true"       # Enable event publishing in K8s
    daprPubsubName: "pubsub-kafka"
    daprPublishTimeout: "2.0"

# Kafka (disabled by default - use managed streaming in production)
# T-001: Kafka configuration
# Plan ref: Plan ยง3.1 (Topics), Plan ยง2.3 (Resource Budgets)
kafka:
  enabled: false
  image:
    repository: apache/kafka
    tag: "3.7.0"
    pullPolicy: IfNotPresent
  resources:
    limits:
      memory: "512Mi"
      cpu: "500m"
    requests:
      memory: "256Mi"
      cpu: "250m"
  # KRaft cluster ID (must be consistent across restarts)
  clusterId: "MkU3OEVBNTcwNTJENDM2Qk"
  # 7-day retention per spec FR-030
  retention:
    ms: "604800000"
  # Topic defaults
  topics:
    partitions: 3
    replicationFactor: 1
  probes:
    readiness:
      initialDelaySeconds: 30
      periodSeconds: 10
    liveness:
      initialDelaySeconds: 60
      periodSeconds: 15

# PostgreSQL (disabled by default - use external DB in production)
postgres:
  enabled: false
  user: "pakaura"
  password: ""
  database: "pakaura_db"

# Dapr components configuration
# T-006: Dapr pubsub, state store, secret store
# Plan ref: Plan ยง4.1 (Component Inventory)
dapr:
  enabled: false  # Set to true when Dapr is installed on the cluster
  pubsub:
    type: "pubsub.kafka"
  statestore:
    type: "state.in-memory"  # Local default; production overrides to state.redis
    redis:
      host: ""
      password: ""
  secretstore:
    type: "secretstores.kubernetes"

# Secrets (MUST be set via --set or external management)
secrets:
  databaseUrl: ""     # REQUIRED - Neon PostgreSQL URL
  jwtSecret: ""       # REQUIRED
  cohereApiKey: ""    # Optional - empty enables demo mode
